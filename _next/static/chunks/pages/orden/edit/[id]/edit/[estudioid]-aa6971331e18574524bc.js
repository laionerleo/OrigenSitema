_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[87],{L4s6:function(e,t,a){"use strict";var c=a("nKUr");t.a=function(e){var t=e.title,a=e.subtitle,s=e.right,o=void 0===s?null:s;return Object(c.jsx)("div",{className:"section-title w-full mb-6 pt-3",children:Object(c.jsxs)("div",{className:"flex flex-row items-center justify-between mb-4",children:[Object(c.jsxs)("div",{className:"flex flex-col",children:[Object(c.jsx)("div",{className:"text-xs uppercase font-light text-gray-500",children:t}),Object(c.jsx)("div",{className:"text-xl font-bold",children:a})]}),o]})})}},QbUL:function(e,t,a){"use strict";a.r(t);var c=a("ODXe"),s=a("h4VS"),o=a("nKUr"),r=a("q1tI"),i=a("jRMg"),n=a("nOHt"),l=a("KYPV"),d=a("YFqc"),u=a.n(d),b=a("qGs6"),m=a.n(b),j=a("qKvR"),f=a("y2g3"),h=a.n(f),O=a("wd/R"),v=a.n(O),x=a("hKE6"),p=a("L4s6"),g=a("6nGu"),D=a("gWdR"),N=a("IqVg"),E=a("VreA"),w=a("iX8M"),M=a("DFyN"),Y=a("TCCB"),I=a("z0WU"),y=a("NRhA"),R=a.n(y),S=(a("5Buo"),a("1UYf"));function C(){var e=Object(s.a)(["\n  display: block;\n  margin: 0 auto;\n  border-color: '#000';\n"]);return C=function(){return e},e}Object(y.registerLocale)("es",S.a);var _=Object(j.css)(C());t.default=Object(M.a)((function(){var e=Object(r.useState)(!0),t=e[0],a=e[1],s=Object(r.useState)([]),d=s[0],b=s[1],j=Object(r.useState)([]),f=j[0],O=j[1],M=Object(r.useState)(null),y=(M[0],M[1]),S=Object(r.useState)({}),C=S[0],P=S[1],T=(Object(Y.b)().userInformation,Object(n.useRouter)()),q=T.query,F=q.estudioID,k=q.id,L=Object(i.c)(E.i),V=Object(c.a)(L,1)[0],A=Object(i.d)(w.w),U=Object(c.a)(A,1)[0],H=Object(l.b)({initialValues:C,enableReinitialize:!0,onSubmit:function(e){var t=f.camposEstudio.map((function(t){return"observaciones"!==t.nombre&&"observacion"!==t.nombre||(t.valor=e.observaciones),t})),a=6e4*(new Date).getTimezoneOffset(),c=new Date(e.fechaTomaDeMuestra-a).toISOString().slice(0,-1),s=e.showObservation?{estadoEstudio:e.estadoEstudio,fechaTomaDeMuestra:c,fechaReporte:e.fechaReporte?v()(e.fechaReporte).utc().format("YYYY-MM-DD"):"",fechaSolicitud:v()(f.fechaSolicitud).utc().format("YYYY-MM-DD"),tipoDeMuestraID:e.tipoDeMuestraID,camposEstudio:t}:{estadoEstudio:e.estadoEstudio,fechaTomaDeMuestra:c,fechaReporte:e.fechaReporte?v()(e.fechaReporte).utc().format("YYYY-MM-DD"):"",fechaSolicitud:v()(f.fechaSolicitud).utc().format("YYYY-MM-DD"),tipoDeMuestraID:e.tipoDeMuestraID};U({variables:{id:f.id,input:s}}).then((function(e){var t=e.data,a=e.error;if(a){console.log(a);var c="Hubo un error al editar la informaci\xf3n del estudio.";return a.graphQLErrors&&a.graphQLErrors.length>0&&a.graphQLErrors.map((function(e){c+="\n".concat(e.message," ")})),Object(N.a)("error",c),void T.push("/orden/detail/".concat(k))}t.editDataEstudio&&(Object(N.a)("success","Los datos del estudio fueron actualizados correctamente."),T.push("/orden/detail/".concat(k)))}))}});var Q=function(e){return!1!==Object(I.r)(e,"observaciones")||!1!==Object(I.r)(e,"observacion")};Object(r.useEffect)((function(){T.query.estudioID&&function(e){V({variables:{id:e}}).then((function(e){var t,c=e.data,s=e.error;if(s){console.log(s);var o="Hubo un error al obtener la informaci\xf3n del estudio.";return s.graphQLErrors&&s.graphQLErrors.length>0&&s.graphQLErrors.map((function(e){o+="\n".concat(e.message," ")})),Object(N.a)("error",o),void T.push("/buscar-orden")}if(!c.getEstudioPorOrden)return Object(N.a)("error","El estudio a editar no existe."),void T.push("/orden/edit/".concat(T.query.id));if(c&&c.getEstudioPorOrden){var r=new Date(v()(c.getEstudioPorOrden.fechaTomaDeMuestra).utcOffset(0,!1).format("MM/DD/YYYY HH:mm"));O(c.getEstudioPorOrden);var i=[];i.push({title:"Inicio",url:"/dashboard",last:!1}),i.push({title:"Buscar Orden",url:"/buscar-orden",last:!1}),i.push({title:"Editar Orden #".concat(c.getEstudioPorOrden.ordenNo),url:"/orden/edit/".concat(T.query.id),last:!1}),i.push({title:"Edici\xf3n estudio ".concat(c.getEstudioPorOrden.codigoEstudio).concat(c.getEstudioPorOrden.estudioNumero),url:"/orden/edit/".concat(T.query.id,"/edit/").concat(F),last:!0}),b(i),y(K(c.getEstudioPorOrden.camposEstudio)),P({estadoEstudio:c.getEstudioPorOrden.estadoEstudio,fechaReporte:c.getEstudioPorOrden.fechaReporte?v()(c.getEstudioPorOrden.fechaReporte).utc():"",tipoDeMuestraID:c.getEstudioPorOrden.tipoDeMuestraID.id,fechaTomaDeMuestra:r,observaciones:(t=c.getEstudioPorOrden.camposEstudio,!1===Object(I.r)(t,"observaciones")?Object(I.q)(t,"observacion"):Object(I.q)(t,"observaciones")),showObservation:Q(c.getEstudioPorOrden.camposEstudio)})}a(!1)}))}(T.query.estudioID)}),[T.query]),Object(r.useEffect)((function(){if(f&&f.estudioID)switch(f.estudioID.id){case"604e2602cc5c345ec442f32e":if(H.values.cutoff_igg&&H.values.cutoff_igm&&H.values.factor_multiplicador){if(H.values.valor_igg){var e=Number(Number(H.values.valor_igg)*Number(H.values.factor_multiplicador)/Number(H.values.cutoff_igg)).toFixed(1),t=Object(I.q)(f.camposEstudio,"resultado_igg","unidad"),a=Object(I.n)(e,Number(H.values.factor_multiplicador));H.setFieldValue("resultado_igg","".concat(e," ").concat(t," ").concat(a))}if(H.values.valor_igm){var c=Number(Number(H.values.valor_igm)*Number(H.values.factor_multiplicador)/Number(H.values.cutoff_igm)).toFixed(1),s=Object(I.q)(f.camposEstudio,"resultado_igg","unidad"),o=Object(I.n)(c,Number(H.values.factor_multiplicador));H.setFieldValue("resultado_igm","".concat(c," ").concat(s," ").concat(o))}}}}),[H.values]);var K=function(e,t){var a=[],c=[],s=0,o=e.filter((function(e){if("DIVISOR"==e.tipo)return s>0&&(a[s-1].campos=c),a.push({index:s,title:e.label,active:!1,campos:[],content:null}),c=[],s++,e;s>0&&c.push(e)}));return c.length>0&&a.length>0&&(a[s-1].campos=c),"count"===t?o.length:a};return t||!F?Object(o.jsxs)("div",{children:[Object(o.jsx)("div",{className:"flex flex-row mb-4",children:Object(o.jsx)("div",{className:"w-full",children:Object(o.jsx)(g.a,{items:d,home:!0,icon:"arrow"})})}),Object(o.jsx)("div",{className:"w-full px-4",children:Object(o.jsx)("div",{children:Object(o.jsx)(m.a,{css:_,size:80,color:"#000"})})})]}):Object(o.jsxs)("div",{children:[Object(o.jsx)("div",{className:"flex flex-row mb-4",children:Object(o.jsx)("div",{className:"w-full",children:Object(o.jsx)(g.a,{items:d,home:!0,icon:"arrow"})})}),Object(o.jsxs)("div",{className:"w-full px-4",children:[Object(o.jsx)(p.a,{title:"Orden No. ".concat(f.ordenNo," | Estudio: ").concat(f.estudioID.nombre," | ").concat(f.codigoEstudio).concat(f.estudioNumero),subtitle:Object(o.jsx)(u.a,{href:"/pacientes/detalle/".concat(f.ordenID.clientID.id),children:"Paciente: ".concat(f.ordenID.clientID.nombres," ").concat(f.ordenID.clientID.apellidos)})}),Object(o.jsx)(D.a,{title:"",description:Object(o.jsx)("span",{children:"Datos generales"}),children:Object(o.jsx)("div",{className:"flex flex-col lg:flex-row lg:flex-wrap w-full lg:space-x-4",children:Object(o.jsxs)("div",{className:"flex flex-col w-3/4",children:[Object(o.jsxs)("div",{className:"text-sm mb-1",children:["Fecha Solicitud: ","".concat(v()(f.fechaSolicitud).utc().format("DD/MM/YYYY"))]}),Object(o.jsxs)("div",{className:"text-sm mb-1",children:["Fecha Toma de muestra:","00:00"===v()(f.fechaTomaDeMuestra).utc().format("HH:mm")?" ".concat(v()(f.fechaTomaDeMuestra).utc().format("DD/MM/YYYY")):" ".concat(v()(f.fechaTomaDeMuestra).utc().format("DD/MM/YYYY HH:mm"))]}),Object(o.jsxs)("div",{className:"text-sm mb-1",children:["Tipo de muestra: ",f.tipoDeMuestraID.nombre]}),Object(o.jsxs)("div",{className:"text-sm mb-1",children:["Tipo de cliente: ",f.ordenID.proveedorID.nombre]}),Object(o.jsxs)("div",{className:"text-sm mb-1",children:["Nota/Informaci\xf3n clinica Relevante: ",f.ordenID.nota]})]})})}),Object(o.jsx)(D.a,{title:"",description:Object(o.jsx)("span",{children:"Datos del Estudio"}),children:Object(o.jsxs)("div",{className:"w-full sm:w-full md:w-full lg:w-2/4 xl:w-1/4 pl-3",children:[Object(o.jsxs)("div",{className:"form-element",children:[Object(o.jsx)("div",{className:"form-label",children:"Fecha de Toma de muestra"}),Object(o.jsx)(R.a,{showTimeSelect:!0,locale:"es",dateFormat:"dd-MM-yyyy",selected:H.values.fechaTomaDeMuestra,onChange:function(e){H.setFieldValue("fechaTomaDeMuestra",e)},className:"text-sm"})]}),f.fechaReporte?Object(o.jsxs)("div",{className:"form-element",children:[Object(o.jsx)("div",{className:"form-label",children:"Fecha del informe"}),Object(o.jsx)(h.a,{locale:"es",name:"fechaReporte",dateFormat:"DD-MM-YYYY",timeFormat:!1,isValidDate:function(e){return e.isBefore(v()())&&e.isSameOrAfter(v()(f.fechaSolicitud).utc())},input:!0,closeOnSelect:!0,inputProps:{className:"form-input",placeholder:"Seleccione una fecha"},viewMode:"days",value:H.values.fechaReporte,onChange:function(e){H.setFieldValue("fechaReporte",e)}})]}):null,f.estudioID.tipoDeMuestras.length>1?Object(o.jsxs)("div",{className:"form-element",children:[Object(o.jsx)("div",{className:"form-label",children:"Tipo de Muestra"}),Object(o.jsxs)("select",{className:"form-select",name:"tipoDeMuestraID",placeholder:"Seleccione",onChange:H.handleChange,value:H.values.tipoDeMuestraID,children:[Object(o.jsx)("option",{value:"",children:"Seleccione una opcion"}),f.estudioID.tipoDeMuestras.map((function(e,t){return Object(o.jsx)("option",{value:e.id,children:e.nombre},"tdm".concat(t))}))]})]}):null,Object(o.jsxs)("div",{className:"form-element",children:[Object(o.jsx)("div",{className:"form-label",children:"Estado del Estudio"}),Object(o.jsxs)("select",{className:"form-select",name:"estadoEstudio",placeholder:"Seleccione",onChange:H.handleChange,value:H.values.estadoEstudio,disabled:"PROCESADO"===f.estadoEstudio,children:[Object(o.jsx)("option",{value:"",children:"Seleccione una opcion"}),Object(o.jsx)("option",{value:"RECIBIDO",children:"Recibido"}),Object(o.jsx)("option",{value:"EN_PROCESO",children:"En Proceso"}),Object(o.jsx)("option",{value:"PROCESADO",children:"Procesado"}),Object(o.jsx)("option",{value:"CANCELADO",children:"Cancelado"})]})]}),H.values.showObservation?Object(o.jsxs)("div",{className:"form-element",children:[Object(o.jsx)("div",{className:"form-label",children:"Observaciones"}),Object(o.jsx)("textarea",{name:"observaciones",type:"text",rows:5,className:"form-select",placeholder:"",onChange:H.handleChange,value:H.values.observaciones})]}):null,Object(o.jsx)("div",{className:"form-element",children:Object(o.jsx)("button",{type:"submit",onClick:H.handleSubmit,className:"inline-block px-6 py-1 mt-2 mx-auto mb-3 text-xs font-medium leading-6 text-center text-white uppercase transition bg-blue-700 rounded-full shadow ripple hover:shadow-lg hover:bg-blue-800 focus:outline-none",children:"Guardar"})})]})}),Object(o.jsx)(D.a,{description:"Documentos adjuntos",children:Object(o.jsx)(x.a,{estudioOrderId:F})})]})]})}))},ftaV:function(e,t,a){"use strict";var c=a("nKUr"),s=a("TSYQ"),o=a.n(s);t.a=function(e){var t=e.className,a=e.round,s=e.height,r=e.width;return Object(c.jsx)("div",{className:o()(t,"shimmer","shimmer-line",{"shimmer-round":a}),style:{height:s,width:r}})}},hKE6:function(e,t,a){"use strict";var c=a("ODXe"),s=a("nKUr"),o=a("q1tI"),r=a("jRMg"),i=function(e){var t=e.accept,a=void 0===t?[]:t,c=e.onChange;return Object(s.jsxs)("div",{children:[Object(s.jsxs)("div",{className:"relative h-40 rounded-lg border-dashed border-2 border-gray-200 bg-white flex justify-center items-center hover:cursor-pointer",children:[Object(s.jsx)("div",{className:"absolute",children:Object(s.jsx)("div",{className:"flex flex-col items-center",children:Object(s.jsx)("span",{className:"block text-blue-400 font-normal",children:"Haz click aqu\xed para cargar un archivo"})})}),Object(s.jsx)("input",{type:"file",className:"h-full w-full opacity-0",accept:a.join(","),onChange:c})]}),Object(s.jsxs)("div",{className:"flex justify-between items-center text-gray-400",children:[Object(s.jsx)("span",{children:"Solo se aceptan archivos de tipo: PDF, DOC, DOCX, JPG, PNG"}),Object(s.jsx)("span",{className:"flex items-center ",children:"Max. 5MB"})]})]})},n=a("ma3e"),l=a("ftaV"),d=a("n7fY"),u=function(e){var t=e.id,a=e.fileName,c=e.fileURL,r=e.loading,i=e.mimeType,u=e.onRemove,b=Object(o.useCallback)((function(){u&&u(t)}),[t]);return r?Object(s.jsxs)("div",{children:[Object(s.jsx)(l.a,{height:"10px",className:"mb-1"}),Object(s.jsx)(l.a,{height:"10px",width:"20%"})]}):Object(s.jsxs)("div",{className:"flex items-start justify-start p-2 space-x-4",children:[Object(s.jsxs)("div",{className:"flex flex-col w-full",children:[Object(s.jsx)("div",{className:"text-sm font-bold",children:a}),Object(s.jsx)("div",{className:"text-sm text-gray-500",children:i})]}),Object(s.jsxs)("div",{className:"flex-shrink-0",children:[Object(s.jsx)("a",{className:"btn btn-default bg-transparent bg-rounded hover:bg-blue-50 hover:text-blue-600 text-blue-500",href:c,target:"_blank",children:"DESCARGAR"}),Object(s.jsx)(d.a,{color:"danger",flat:!0,rounded:!0,onClick:b,children:Object(s.jsx)(n.i,{style:{display:"inline"}})})]})]})},b=a("VreA"),m=a("iX8M");t.a=function(e){var t=e.estudioOrderId,a=Object(o.useState)(),n=a[0],l=a[1],d=Object(r.e)(b.a,{variables:{id:t},refetchAfterMutations:[{mutation:m.b},{mutation:m.C}]}),j=(d.loading,d.data),f=Object(r.d)(m.b),h=Object(c.a)(f,2),O=h[0],v=h[1].loading,x=Object(r.d)(m.C),p=Object(c.a)(x,1)[0],g=Object(o.useCallback)((function(e){var a=e.target;a.validity&&O({variables:{id:t,file:a.files[0]}})}),[t]),D=Object(o.useCallback)((function(e){confirm("Estas seguro de eliminar?")&&(l(e),p({variables:{id:t,fileId:e}}))}),[t]),N=Object(o.useMemo)((function(){return(null===j||void 0===j?void 0:j.getEstudioPorOrden)?j.getEstudioPorOrden.attachmentFiles:[]}),[j]);return Object(s.jsxs)("div",{children:[Object(s.jsxs)("div",{className:"w-full mb-4",children:[N.map((function(e){return Object(s.jsx)(u,{id:e.id,fileName:e.name,fileURL:e.url,mimeType:e.mimeType,onRemove:D,loading:n===e.id})})),v&&Object(s.jsx)(u,{loading:!0})]}),Object(s.jsx)(i,{accept:[".pdf",".doc",".docx",".jpg",".png"],onChange:g})]})}},n7fY:function(e,t,a){"use strict";var c=a("nKUr"),s=a("TSYQ"),o=a.n(s);t.a=function(e){var t=e.children,a=e.circle,s=e.color,r=e.flat,i=e.rounded,n=e.onClick;return Object(c.jsx)("button",{className:o()("btn btn-default",{"bg-blue-500":!r&&null==s,"bg-red-500":!r&&null!=s,"bg-transparent":r,"bg-rounded":i,"bg-circle":a,"hover:bg-blue-50":null==s,"hover:bg-red-50":"danger"===s,"hover:text-blue-600":null==s,"hover:text-red-600":"danger"===s,"text-blue-500":r&&null==s,"text-red-500":r&&"danger"===s,"text-white":!r}),onClick:n,children:t})}},z1ED:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/orden/edit/[id]/edit/[estudioID]",function(){return a("QbUL")}])}},[["z1ED",0,1,4,10,5,11,7,25,2,3,6,8,9,12,14,13,15,18,29,41,42]]]);