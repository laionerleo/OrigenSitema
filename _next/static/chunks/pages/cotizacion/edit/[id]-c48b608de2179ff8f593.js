_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[66],{Cmx8:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cotizacion/edit/[id]",function(){return t("qzRM")}])},iX8M:function(n,e,t){"use strict";t.d(e,"B",(function(){return i})),t.d(e,"L",(function(){return o})),t.d(e,"J",(function(){return d})),t.d(e,"F",(function(){return r})),t.d(e,"c",(function(){return a})),t.d(e,"t",(function(){return u})),t.d(e,"T",(function(){return c})),t.d(e,"H",(function(){return s})),t.d(e,"G",(function(){return l})),t.d(e,"M",(function(){return p})),t.d(e,"D",(function(){return m})),t.d(e,"N",(function(){return f})),t.d(e,"S",(function(){return b})),t.d(e,"j",(function(){return h})),t.d(e,"z",(function(){return j})),t.d(e,"r",(function(){return $})),t.d(e,"e",(function(){return x})),t.d(e,"f",(function(){return O})),t.d(e,"k",(function(){return v})),t.d(e,"A",(function(){return I})),t.d(e,"h",(function(){return g})),t.d(e,"P",(function(){return D})),t.d(e,"v",(function(){return P})),t.d(e,"n",(function(){return w})),t.d(e,"p",(function(){return E})),t.d(e,"a",(function(){return S})),t.d(e,"s",(function(){return z})),t.d(e,"l",(function(){return C})),t.d(e,"i",(function(){return N})),t.d(e,"y",(function(){return y})),t.d(e,"q",(function(){return M})),t.d(e,"I",(function(){return _})),t.d(e,"Q",(function(){return F})),t.d(e,"R",(function(){return R})),t.d(e,"E",(function(){return T})),t.d(e,"g",(function(){return A})),t.d(e,"x",(function(){return U})),t.d(e,"o",(function(){return V})),t.d(e,"w",(function(){return k})),t.d(e,"b",(function(){return q})),t.d(e,"C",(function(){return B})),t.d(e,"K",(function(){return Y})),t.d(e,"O",(function(){return L})),t.d(e,"d",(function(){return H})),t.d(e,"u",(function(){return Q})),t.d(e,"m",(function(){return X}));var i="\n  mutation login($email: String!, $password: String!) {\n    login(email: $email, password: $password) {\n      id\n      token\n      email\n      nombre\n      apellido\n      role\n      compania\n      areasDeEstudio {\n        nombre\n        id\n      }\n    }\n  }\n",o="\n  mutation createUser($input: UserInput) {\n    createUser(input: $input)\n  }\n",d="\nmutation setPassword($hash: String!, $password: String!) {\n  setPassword(hash: $hash, password: $password)\n}\n",r="\nmutation forgotPassword($email: String!) {\n  forgotPassword(email: $email)\n}\n",a="\n  mutation addClient($input: ClientInput) {\n    addClient(input: $input) {\n      id\n      nombres\n      apellidos\n      ci\n      fecha_nacimiento\n      telefono\n      municipio\n      departamento\n      direccion\n      sexo\n      edad\n    }\n  }\n",u="\n  mutation editClient($input: ClientEditInput) {\n    editClient(input: $input) {\n      id\n      nombres\n      apellidos\n      ci\n      fecha_nacimiento\n      telefono\n      municipio\n      departamento\n      direccion\n      sexo\n      edad\n    }\n  }\n",c="\nmutation editTipoFicha($id: ID!, $tipoFicha: String!) {\n  editTipoFicha(id: $id, tipoFicha: $tipoFicha) {\n    codigo\n  }\n}\n",s="\nmutation setCodigoInterno($id: ID!, $codigoInterno: String!) {\n  setCodigoInterno(id: $id, codigoInterno: $codigoInterno) {\n    codigoInterno\n  }\n}\n",l="\n  mutation setConciliacionFicha($input: FichaConciliacionInput) {\n    setConciliacionFicha(input: $input) {\n      codigo\n    }\n  }\n",p="\nmutation loadReports($informes: [Reportes]) {\n  loadReports(informes: $informes)\n}\n",m="\n  mutation deleteClient($id: ID) {\n    deleteClient(id: $id)\n  }\n",f="\nmutation updateUser($input: UserEditInput) {\n  updateUser(input: $input) {\n    id\n    email\n    nombre\n    apellido\n    role\n    permissions\n    approved\n    compania\n    keywords\n  }\n}\n",b="\n  mutation updateSystemUserPrivilegesUser($input: UserPrivilegesInput) {\n    updateSystemUserPrivilegesUser(input: $input) {\n      id\n      nombre\n      role\n      approved\n    }\n  }\n",h="\nmutation addTipoDeMuestra($input: TipoDeMuestraInput) {\n  addTipoDeMuestra(input: $input) {\n    nombre\n    description\n    estatus\n    id\n  }\n}\n",j="\nmutation editTipoDeMuestra($id: ID!, $input: TipoDeMuestraInput) {\n  editTipoDeMuestra(id: $id, input: $input) {\n    nombre\n    description\n    id\n    estatus\n  }\n}\n",$="\nmutation deleteTipoDeMuestra($id: ID!) {\n  deleteTipoDeMuestra(id: $id)\n}\n",x="\nmutation addEstudio($input: EstudioInput) {\n  addEstudio(input: $input) {\n    id\n    nombre\n    codigo\n    description\n    metodo\n    estatus\n    areaDeEstudioID {\n      nombre\n    }\n    tipoDeMuestras {\n      nombre\n    }\n  }\n}\n",O="\nmutation addHistorial($input: HistorialPrecioPorProveedorInput) {\n    addHistorial(input: $input) {\n        id\n        precio\n        fecha_inicio    \n        fecha_limite    \n        estudioID\n        proveedorID\n  }\n}\n",v="\nmutation addVacuna($input: VacunaInput) {\n    addVacuna(input: $input) {\n        id\n        dosisPrimera\n        dosisSegunda\n        dosisUnica\n        dosisRefuerzoPrimero\n        dosisRefuerzoSegundo\n        clientID\n        fechaUltimoTest\n  }\n}\n",I="\nmutation editVacuna($input: VacunaEditInput) {\n    editVacuna(input: $input) {\n        id\n        dosisPrimera\n        dosisSegunda\n        dosisUnica\n        dosisRefuerzoPrimero\n        dosisRefuerzoSegundo\n        fechaUltimoTest\n    }\n}\n",g="\nmutation addPerfil($input: PerfilInput) {\n  addPerfil(input: $input) {\n    id\n    nombre\n    estatus\n    estudios {\n      id\n      nombre\n      precio\n    }\n  }\n}\n",D="\nmutation updatePerfil($id: ID!, $input: PerfilInput) {\n  updatePerfil(id: $id, input: $input) {\n    id\n    nombre\n    estatus\n    estudios {\n      id\n      nombre\n      precio\n    }\n  }\n}\n",P="\nmutation editEstudio($id: ID!, $input: EstudioInput) {\n  editEstudio(id: $id, input: $input) {\n    id\n    nombre\n    codigo\n    description\n    metodo\n    estatus\n    areaDeEstudioID {\n      nombre\n    }\n    tipoDeMuestras {\n      nombre\n    }\n  }\n}\n",w="\nmutation deleteEstudio($id: ID!) {\n  deleteEstudio(id: $id)\n}\n",E="\nmutation deletePerfil($id: ID!) {\n  deletePerfil(id: $id)\n}\n",S="\nmutation addAreaEstudio($input: AreaEstudioInput) {\n  addAreaEstudio(input: $input) {\n    nombre\n    id\n  }\n}\n",z="\nmutation editAreaEstudio($id: ID!, $input: AreaEstudioInput) {\n  editAreaEstudio(id: $id, input: $input) {\n    nombre\n    id\n  }\n}\n",C="\nmutation deleteAreaEstudio($id: ID!) {\n  deleteAreaEstudio(id: $id)\n}\n",N="\nmutation addProveedor($input: ProveedorInput) {\n  addProveedor(input: $input) {\n    id\n    nombre\n    description\n    estatus\n  }\n}\n",y="\nmutation editProveedor($id: ID!, $input: ProveedorInput) {\n  editProveedor(id: $id, input: $input) {\n    id\n    nombre\n    description\n    estatus\n  }\n}\n",M="\nmutation deleteProveedor($id: ID!) {\n  deleteProveedor(id: $id)\n}\n",_="\nmutation setPrecioEstudio($input: PreciosPorOrdenInput) {\n  setPrecioEstudio(input: $input) {\n    id\n  }\n}\n",F="\nmutation updatePrecioProveedor($id: ID!, $input: PreciosPorOrdenInput) {\n  updatePrecioProveedor(id: $id, input: $input) {\n    id\n  }\n}\n",R="\nmutation updatePrecioOrdenPorEstudio($id: ID!, $input: PreciosPorOrdenEstudioInput) {\n  updatePrecioOrdenPorEstudio(id: $id, input: $input) {\n    id\n  }\n}\n",T="\nmutation deleteItem($id: ID!) {\n  deleteItem(id: $id)\n}\n",A="\nmutation addOrden($input: OrdenInput, $estudios: [EstudioPorOrdenInput]) {\n  addOrden(input: $input, estudios: $estudios) {\n    id\n    fechaSolicitud\n  }\n}\n",U="\nmutation editOrden($id: ID!, $input: OrdenInput, $estudios: [EstudioEditPrecio]) {\n  editOrden(id: $id, input: $input, estudios: $estudios) {\n    id\n  }\n}\n",V="\nmutation deleteOrden($id: ID!) {\n  deleteOrden(id: $id)\n}\n",k="\nmutation editDataEstudio($id: ID!, $input: EstudioPorOrdenEditSimpleInput) {\n  editDataEstudio(id: $id, input: $input) {\n    id\n    codigoEstudio\n  }\n}\n",q="\nmutation addAttachmentFileEstudioPorOrden($id: ID, $file: Upload) {\n  addAttachmentFileEstudioPorOrden(id: $id, file: $file) {\n    id\n    attachmentFiles {\n      id\n      name\n      mimeType\n      url\n    }\n  }\n}\n",B="\nmutation removeAttachmentFileEstudioPorOrden($id: ID, $fileId: ID) {\n  removeAttachmentFileEstudioPorOrden(id: $id, fileId: $fileId) {\n    id\n    attachmentFiles {\n      id\n      name\n      mimeType\n      url\n    }\n  }\n}\n",Y="\nmutation setResultEstudio($id: ID!, $input: EstudioPorOrdenSetResultInput) {\n  setResultEstudio(id: $id, input: $input) {\n    id\n    codigoEstudio\n  }\n}\n",L="\nmutation updateOrderByFile($ordenes: [OrdenConciliacionByFileInput]) {\n  updateOrderByFile(ordenes: $ordenes)\n}\n",H="\nmutation addCotizacion($input: CotizacionInput, $estudios: [EstudioPorCotizacionInput]) {\n  addCotizacion(input: $input, estudios: $estudios) {\n    id\n    fechaSolicitud\n  }\n}\n",Q="\nmutation editCotizacion($id: ID!, $input: CotizacionInput, $estudios: [EstudioEditPrecio]) {\n  editCotizacion(id: $id, input: $input, estudios: $estudios) {\n    id\n  }\n}\n",X="\nmutation deleteCotizacion($id: ID!) {\n  deleteCotizacion(id: $id)\n}\n"},qzRM:function(n,e,t){"use strict";t.r(e);var i=t("ODXe"),o=t("h4VS"),d=t("nKUr"),r=t("q1tI"),a=t("jRMg"),u=t("nOHt"),c=t("YFqc"),s=t.n(c),l=t("DFyN"),p=t("VreA"),m=t("iX8M"),f=t("6nGu"),b=t("gWdR"),h=(t("B3WN"),t("KYPV")),j=t("UGp+"),$=t("y2g3"),x=t.n($),O=t("wd/R"),v=t.n(O),I={fechaSolicitud:"",listaSucursal:"",tipo_cliente_selected:"",tipo_cliente:{},nombreMedico:"",contratista:"",nota:""},g=function(n){var e=n.orden,t=n.onSubmit,o=n.waiting,u=(n.onChangeProvider,n.blockForm),c=Object(a.c)(p.Y),s=Object(i.a)(c,1)[0],l=Object(a.c)(p.V),m=(Object(i.a)(l,1)[0],Object(r.useState)([])),f=(m[0],m[1]),b=Object(r.useState)([]);b[0],b[1];Object(r.useEffect)((function(){var n;e&&(n=e.tipo_cliente_selected,s({variables:{tipo:n}}).then((function(n){var e=n.data;e.getProveedoresByTipo&&f(e.getProveedoresByTipo)})))}),[e]);var $=j.f({fechaSolicitud:j.c(),listaSucursal:j.h(),tipo_cliente_selected:j.h(),tipo_cliente:j.f(),nombreMedico:j.h(),fechaFactura:j.c(),contratista:j.h(),nota:j.h()}),O=Object(h.b)({initialValues:e||I,validationSchema:$,onSubmit:t});return Object(d.jsxs)("form",{onSubmit:O.handleSubmit,className:"flex flex-col lg:flex-row lg:flex-wrap w-full",children:[Object(d.jsx)("div",{className:"w-full sm:w-full md:w-full lg:w-2/4 xl:w-1/4 pl-3",children:Object(d.jsxs)("div",{className:"form-element",children:[Object(d.jsx)("div",{className:"form-label",children:"Fecha de Registro"}),Object(d.jsx)(x.a,{locale:"es",name:"fechaSolicitud",dateFormat:"DD-MM-YYYY",timeFormat:!1,isValidDate:function(n){return n.isBefore(v()())},input:!0,closeOnSelect:!0,inputProps:{disabled:"disabled",className:"form-input",placeholder:"Seleccione una fecha"},viewMode:"days",value:O.values.fechaSolicitud,onChange:function(n){O.setFieldValue("fechaSolicitud",n)}}),O.errors.fechaSolicitud&&O.touched.fechaSolicitud?Object(d.jsx)("div",{className:"form-error",children:O.errors.fechaSolicitud}):null]})}),Object(d.jsx)("div",{className:"flex flex-col lg:flex-row lg:flex-wrap w-full mt-4 pr-5 justify-center",children:Object(d.jsxs)("button",{className:"inline-block px-6 py-2 my-2 text-xs font-medium leading-6 text-center text-white uppercase transition bg-blue-700 rounded-full shadow ripple hover:shadow-lg hover:bg-blue-800 focus:outline-none disabled:opacity-50 mx-auto ",type:"submit",disabled:u,children:[o?Object(d.jsxs)("svg",{className:" inline-block animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[Object(d.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),Object(d.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,o?"Actualizando ":"Actualizar ","Cotizacion"]})})]})},D=t("IqVg"),P=t("qGs6"),w=t.n(P),E=t("qKvR");function S(){var n=Object(o.a)(["\n  display: block;\n  margin: 0 auto;\n  border-color: '#000';\n"]);return S=function(){return n},n}var z=Object(E.css)(S());e.default=Object(l.a)((function(){var n=Object(a.c)(p.g),e=Object(i.a)(n,1)[0],t=Object(a.d)(m.u),o=Object(i.a)(t,1)[0],c=Object(r.useState)(!1),l=c[0],h=c[1],j=Object(r.useState)(null),$=j[0],x=j[1],O=Object(r.useState)(!1),I=O[0],P=O[1],E=Object(r.useState)(null),S=E[0],C=E[1],N=Object(r.useState)(null),y=N[0],M=N[1],_=Object(r.useState)(null),F=_[0],R=_[1],T=Object(u.useRouter)(),A=T.query.id,U=[{title:"Inicio",url:"/dashboard",last:!1},{title:"Buscar Cotizacion",url:"/buscar-cotizacion",last:!1},{title:"Editar Cotizacion",url:"".concat(A),last:!0}],V=function(n){var e=0;n.map((function(n){e=Number(e)+Number(n.precio)})),R(e)};Object(r.useEffect)((function(){var n;T.query.id&&(n=T.query.id,e({variables:{id:n}}).then((function(n){var e=n.data,t=n.error;if(t){var i="Hubo un error al obtener los datos de la cotizacion.";return t.graphQLErrors&&t.graphQLErrors.length>0&&t.graphQLErrors.map((function(n){i+="\n".concat(n.message," ")})),void Object(D.a)("error",i)}if(!e.getCotizacion)return Object(D.a)("error","La cotizacion a editar no existe."),void T.push("/buscar-cotizacion");if(e&&e.getCotizacionDetalles&&(M(e.getCotizacionDetalles),V(e.getCotizacionDetalles)),e&&e.getCotizacion){var o=e.getCotizacion,d=o.fechaSolicitud,r=o.listaSucursal,a=o.nombreMedico,u=o.contratista,c=o.nota;C({fechaSolicitud:v()(d).utc(),listaSucursal:r,tipo_cliente_selected:e.getCotizacion.proveedorID.tipo,tipo_cliente:{nombre:e.getCotizacion.proveedorID.nombre,id:e.getCotizacion.proveedorID.id},nombreMedico:a,contratista:u||"",nota:c||""}),x(e.getCotizacion)}})))}),[T.query]);return $?Object(d.jsx)("div",{children:Object(d.jsxs)("div",{className:"w-full px-4",children:[Object(d.jsx)("div",{className:"flex flex-row mb-4",children:Object(d.jsx)("div",{className:"w-full",children:Object(d.jsx)(f.a,{items:U,home:!0,icon:"arrow"})})}),Object(d.jsxs)("div",{className:"w-full py-2 px-0",children:[Object(d.jsx)(b.a,{title:"",description:Object(d.jsx)("span",{children:"Datos de la cotizacion"}),right:Object(d.jsx)(s.a,{href:"/pacientes/edit/".concat($.clientID.id),children:Object(d.jsx)("a",{className:"link self-end",children:"Editar Paciente"})}),children:Object(d.jsxs)("div",{className:"flex flex-col lg:flex-row lg:flex-wrap w-full lg:space-x-4",children:[Object(d.jsxs)("div",{className:"flex flex-col w-3/4",children:[Object(d.jsxs)("div",{className:"text-sm mb-1",children:["No. de Cotizacion: ",$.cotizacionNumero]}),Object(d.jsxs)("div",{className:"text-sm mb-1",children:["Nombres: ",$.clientID.nombres]}),Object(d.jsxs)("div",{className:"text-sm mb-1",children:["Apellidos: ",$.clientID.apellidos]}),Object(d.jsxs)("div",{className:"text-sm mb-1",children:["DNI: ",$.clientID.ci]}),Object(d.jsxs)("div",{className:"text-sm mb-1",children:["DNI: ",$.clientID.telefono]})]}),Object(d.jsx)("div",{className:"flex flex-col w-1/4"})]})}),Object(d.jsxs)(b.a,{title:"",description:Object(d.jsx)("span",{children:"Estudios Realizados"}),children:[Object(d.jsx)("div",{className:"flex flex-col w-full",children:Object(d.jsx)("div",{className:"overflow-x-scroll lg:overflow-hidden",children:Object(d.jsxs)("table",{className:"table",children:[Object(d.jsx)("thead",{children:Object(d.jsxs)("tr",{children:[Object(d.jsx)("th",{children:"Nombre"}),Object(d.jsx)("th",{children:"Precio"})]})}),Object(d.jsx)("tbody",{children:y.map((function(n){return Object(d.jsxs)("tr",{children:[Object(d.jsx)("td",{children:n.estudioID.nombre}),Object(d.jsx)("td",{children:n.precio})]},n.id)}))})]})})}),Object(d.jsx)("div",{className:"flex flex-col lg:flex-row lg:flex-wrap w-full mt-4 pr-5 justify-end",children:Object(d.jsxs)("h2",{className:"text-xl text-right",children:["Total Pagado: ",F," Bs"]})})]}),Object(d.jsx)(g,{waiting:l,blockForm:I,orden:S,onSubmit:function(n){h(!0);var e=n.listaSucursal,t=n.tipo_cliente,i=n.fechaSolicitud,d=n.nombreMedico,r=n.contratista,a=n.nota,u={totalAPagar:F.toString(),listaSucursal:e,fechaSolicitud:i.format("YYYY-MM-DD"),clientID:$.clientID.id,proveedorID:t.id,nombreMedico:d,contratista:r,nota:a},c=y.map((function(n){return{id:n.id,precio:n.precio}}));o({variables:{id:$.id,input:u,estudios:c}}).then((function(n){var e=n.error,t=n.data;if(e){var i="Hubo un problema actualizando la informacion de la Cotizacion.";return e.graphQLErrors&&e.graphQLErrors.length>0&&e.graphQLErrors.map((function(n){i+="\n".concat(n.message," ")})),Object(D.a)("error",i),void h(!1)}if(t.editCotizacion)return Object(D.a)("success","La informacion fue actualizada correctamente."),T.push("/cotizacion/detail/".concat(A)),void h(!1)}))},onChangeProvider:function(n){var e=y.map((function(e){var t=n.filter((function(n){if(n.estudioID.id===e.estudioID.id)return n}));return t.length>0?(e.precio=t[0].precio,P(!1)):(Object(D.a)("error","El proveedor seleccionado no tiene un precio asignado para el estudio "+e.estudioID.nombre),P(!0)),e}));M(e),V(e)}})]})]})}):Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{className:"flex flex-row mb-4",children:Object(d.jsx)("div",{className:"w-full",children:Object(d.jsx)(f.a,{items:U,home:!0,icon:"arrow"})})}),Object(d.jsx)("div",{className:"w-full px-4",children:Object(d.jsx)("div",{children:Object(d.jsx)(w.a,{css:z,size:80,color:"#000"})})})]})}))}},[["Cmx8",0,1,4,10,5,11,7,22,2,3,6,8,9,12,14,13,15,16,17,18,26,28]]]);