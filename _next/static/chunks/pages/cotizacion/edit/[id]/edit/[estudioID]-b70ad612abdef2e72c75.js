_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[66],{"1OyB":function(e,t,a){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}a.d(t,"a",(function(){return o}))},BsWD:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var o=a("a3WO");function r(e,t){if(e){if("string"===typeof e)return Object(o.a)(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Object(o.a)(e,t):void 0}}},JX7q:function(e,t,a){"use strict";function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}a.d(t,"a",(function(){return o}))},Ji7U:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var o=a("s4An");function r(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Object(o.a)(e,t)}},L4s6:function(e,t,a){"use strict";var o=a("q1tI"),r=a.n(o).a.createElement;t.a=function(e){var t=e.title,a=e.subtitle,o=e.right,n=void 0===o?null:o;return r("div",{className:"section-title w-full mb-6 pt-3"},r("div",{className:"flex flex-row items-center justify-between mb-4"},r("div",{className:"flex flex-col"},r("div",{className:"text-xs uppercase font-light text-gray-500"},t),r("div",{className:"text-xl font-bold"},a)),n))}},U8pU:function(e,t,a){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}a.d(t,"a",(function(){return o}))},a3WO:function(e,t,a){"use strict";function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}a.d(t,"a",(function(){return o}))},foSv:function(e,t,a){"use strict";function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}a.d(t,"a",(function(){return o}))},ftaV:function(e,t,a){"use strict";var o=a("q1tI"),r=a.n(o),n=a("TSYQ"),i=a.n(n),c=r.a.createElement;t.a=function(e){var t=e.className,a=e.round,o=e.height,r=e.width;return c("div",{className:i()(t,"shimmer","shimmer-line",{"shimmer-round":a}),style:{height:o,width:r}})}},hKE6:function(e,t,a){"use strict";var o=a("xvhg"),r=a("q1tI"),n=a.n(r),i=a("jRMg"),c=n.a.createElement,s=function(e){var t=e.accept,a=void 0===t?[]:t,o=e.onChange;return c("div",null,c("div",{className:"relative h-40 rounded-lg border-dashed border-2 border-gray-200 bg-white flex justify-center items-center hover:cursor-pointer"},c("div",{className:"absolute"},c("div",{className:"flex flex-col items-center"},c("span",{className:"block text-blue-400 font-normal"},"Haz click aqu\xed para cargar un archivo"))),c("input",{type:"file",className:"h-full w-full opacity-0",accept:a.join(","),onChange:o})),c("div",{className:"flex justify-between items-center text-gray-400"},c("span",null,"Solo se aceptan archivos de tipo: PDF, DOC, DOCX, JPG, PNG"),c("span",{className:"flex items-center "},"Max. 5MB")))},u=a("ma3e"),l=a("ftaV"),d=a("n7fY"),f=n.a.createElement,m=function(e){var t=e.id,a=e.fileName,o=e.fileURL,n=e.loading,i=e.mimeType,c=e.onRemove,s=Object(r.useCallback)((function(){c&&c(t)}),[t]);return n?f("div",null,f(l.a,{height:"10px",className:"mb-1"}),f(l.a,{height:"10px",width:"20%"})):f("div",{className:"flex items-start justify-start p-2 space-x-4"},f("div",{className:"flex flex-col w-full"},f("div",{className:"text-sm font-bold"},a),f("div",{className:"text-sm text-gray-500"},i)),f("div",{className:"flex-shrink-0"},f("a",{className:"btn btn-default bg-transparent bg-rounded hover:bg-blue-50 hover:text-blue-600 text-blue-500",href:o,target:"_blank"},"DESCARGAR"),f(d.a,{color:"danger",flat:!0,rounded:!0,onClick:s},f(u.i,{style:{display:"inline"}}))))},b=a("VreA"),v=a("iX8M"),p=n.a.createElement;t.a=function(e){var t=e.estudioOrderId,a=Object(r.useState)(),n=a[0],c=a[1],u=Object(i.e)(b.a,{variables:{id:t},refetchAfterMutations:[{mutation:v.b},{mutation:v.C}]}),l=(u.loading,u.data),d=Object(i.d)(v.b),f=Object(o.a)(d,2),h=f[0],g=f[1].loading,O=Object(i.d)(v.C),D=Object(o.a)(O,1)[0],N=Object(r.useCallback)((function(e){var a=e.target;a.validity&&h({variables:{id:t,file:a.files[0]}})}),[t]),y=Object(r.useCallback)((function(e){confirm("Estas seguro de eliminar?")&&(c(e),D({variables:{id:t,fileId:e}}))}),[t]),E=Object(r.useMemo)((function(){return(null===l||void 0===l?void 0:l.getEstudioPorOrden)?l.getEstudioPorOrden.attachmentFiles:[]}),[l]);return p("div",null,p("div",{className:"w-full mb-4"},E.map((function(e){return p(m,{id:e.id,fileName:e.name,fileURL:e.url,mimeType:e.mimeType,onRemove:y,loading:n===e.id})})),g&&p(m,{loading:!0})),p(s,{accept:[".pdf",".doc",".docx",".jpg",".png"],onChange:N}))}},ioCw:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cotizacion/edit/[id]/edit/[estudioID]",function(){return a("tB1a")}])},md7G:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var o=a("U8pU"),r=a("JX7q");function n(e,t){if(t&&("object"===Object(o.a)(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Object(r.a)(e)}},n7fY:function(e,t,a){"use strict";var o=a("q1tI"),r=a.n(o),n=a("TSYQ"),i=a.n(n),c=r.a.createElement;t.a=function(e){var t=e.children,a=e.circle,o=e.color,r=e.flat,n=e.rounded,s=e.onClick;return c("button",{className:i()("btn btn-default",{"bg-blue-500":!r&&null==o,"bg-red-500":!r&&null!=o,"bg-transparent":r,"bg-rounded":n,"bg-circle":a,"hover:bg-blue-50":null==o,"hover:bg-red-50":"danger"===o,"hover:text-blue-600":null==o,"hover:text-red-600":"danger"===o,"text-blue-500":r&&null==o,"text-red-500":r&&"danger"===o,"text-white":!r}),onClick:s},t)}},o46R:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var o=a("U8pU");function r(e){var t=function(e,t){if("object"!=Object(o.a)(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=Object(o.a)(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Object(o.a)(t)?t:t+""}},rePB:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var o=a("o46R");function r(e,t,a){return(t=Object(o.a)(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},tB1a:function(e,t,a){"use strict";a.r(t);var o=a("xvhg"),r=a("jT3O"),n=a("q1tI"),i=a.n(n),c=a("jRMg"),s=a("nOHt"),u=a("KYPV"),l=a("YFqc"),d=a.n(l),f=a("qGs6"),m=a.n(f),b=a("qKvR"),v=a("y2g3"),p=a.n(v),h=a("wd/R"),g=a.n(h),O=a("hKE6"),D=a("L4s6"),N=a("6nGu"),y=a("gWdR"),E=a("IqVg"),j=a("VreA"),w=a("iX8M"),x=a("DFyN"),M=a("TCCB"),I=a("z0WU"),S=a("NRhA"),Y=a.n(S),P=(a("5Buo"),a("1UYf")),R=i.a.createElement;function C(){var e=Object(r.a)(["\n  display: block;\n  margin: 0 auto;\n  border-color: '#000';\n"]);return C=function(){return e},e}Object(S.registerLocale)("es",P.a);var _=Object(b.css)(C());t.default=Object(x.a)((function(){var e=Object(n.useState)(!0),t=e[0],a=e[1],r=Object(n.useState)([]),i=r[0],l=r[1],f=Object(n.useState)([]),b=f[0],v=f[1],h=Object(n.useState)(null),x=(h[0],h[1]),S=Object(n.useState)({}),P=S[0],C=S[1],T=(Object(M.b)().userInformation,Object(s.useRouter)()),q=T.query,k=q.estudioID,F=q.id,A=Object(c.c)(j.i),L=Object(o.a)(A,1)[0],U=Object(c.d)(w.w),V=Object(o.a)(U,1)[0],B=Object(u.b)({initialValues:P,enableReinitialize:!0,onSubmit:function(e){var t=b.camposEstudio.map((function(t){return"observaciones"!==t.nombre&&"observacion"!==t.nombre||(t.valor=e.observaciones),t})),a=6e4*(new Date).getTimezoneOffset(),o=new Date(e.fechaTomaDeMuestra-a).toISOString().slice(0,-1),r=e.showObservation?{estadoEstudio:e.estadoEstudio,fechaTomaDeMuestra:o,fechaReporte:e.fechaReporte?g()(e.fechaReporte).utc().format("YYYY-MM-DD"):"",fechaSolicitud:g()(b.fechaSolicitud).utc().format("YYYY-MM-DD"),tipoDeMuestraID:e.tipoDeMuestraID,camposEstudio:t}:{estadoEstudio:e.estadoEstudio,fechaTomaDeMuestra:o,fechaReporte:e.fechaReporte?g()(e.fechaReporte).utc().format("YYYY-MM-DD"):"",fechaSolicitud:g()(b.fechaSolicitud).utc().format("YYYY-MM-DD"),tipoDeMuestraID:e.tipoDeMuestraID};V({variables:{id:b.id,input:r}}).then((function(e){var t=e.data,a=e.error;if(a){console.log(a);var o="Hubo un error al editar la informaci\xf3n del estudio.";return a.graphQLErrors&&a.graphQLErrors.length>0&&a.graphQLErrors.map((function(e){o+="\n".concat(e.message," ")})),Object(E.a)("error",o),void T.push("/orden/detail/".concat(F))}t.editDataEstudio&&(Object(E.a)("success","Los datos del estudio fueron actualizados correctamente."),T.push("/orden/detail/".concat(F)))}))}});var H=function(e){return!1!==Object(I.r)(e,"observaciones")||!1!==Object(I.r)(e,"observacion")};Object(n.useEffect)((function(){T.query.estudioID&&function(e){L({variables:{id:e}}).then((function(e){var t,o=e.data,r=e.error;if(r){console.log(r);var n="Hubo un error al obtener la informaci\xf3n del estudio.";return r.graphQLErrors&&r.graphQLErrors.length>0&&r.graphQLErrors.map((function(e){n+="\n".concat(e.message," ")})),Object(E.a)("error",n),void T.push("/buscar-orden")}if(!o.getEstudioPorOrden)return Object(E.a)("error","El estudio a editar no existe."),void T.push("/orden/edit/".concat(T.query.id));if(o&&o.getEstudioPorOrden){var i=new Date(g()(o.getEstudioPorOrden.fechaTomaDeMuestra).utcOffset(0,!1).format("MM/DD/YYYY HH:mm"));v(o.getEstudioPorOrden);var c=[];c.push({title:"Inicio",url:"/dashboard",last:!1}),c.push({title:"Buscar Orden",url:"/buscar-orden",last:!1}),c.push({title:"Editar Orden #".concat(o.getEstudioPorOrden.ordenNo),url:"/orden/edit/".concat(T.query.id),last:!1}),c.push({title:"Edici\xf3n estudio ".concat(o.getEstudioPorOrden.codigoEstudio).concat(o.getEstudioPorOrden.estudioNumero),url:"/orden/edit/".concat(T.query.id,"/edit/").concat(k),last:!0}),l(c),x(Q(o.getEstudioPorOrden.camposEstudio)),C({estadoEstudio:o.getEstudioPorOrden.estadoEstudio,fechaReporte:o.getEstudioPorOrden.fechaReporte?g()(o.getEstudioPorOrden.fechaReporte).utc():"",tipoDeMuestraID:o.getEstudioPorOrden.tipoDeMuestraID.id,fechaTomaDeMuestra:i,observaciones:(t=o.getEstudioPorOrden.camposEstudio,!1===Object(I.r)(t,"observaciones")?Object(I.q)(t,"observacion"):Object(I.q)(t,"observaciones")),showObservation:H(o.getEstudioPorOrden.camposEstudio)})}a(!1)}))}(T.query.estudioID)}),[T.query]),Object(n.useEffect)((function(){if(b&&b.estudioID)switch(b.estudioID.id){case"604e2602cc5c345ec442f32e":if(B.values.cutoff_igg&&B.values.cutoff_igm&&B.values.factor_multiplicador){if(B.values.valor_igg){var e=Number(Number(B.values.valor_igg)*Number(B.values.factor_multiplicador)/Number(B.values.cutoff_igg)).toFixed(1),t=Object(I.q)(b.camposEstudio,"resultado_igg","unidad"),a=Object(I.n)(e,Number(B.values.factor_multiplicador));B.setFieldValue("resultado_igg","".concat(e," ").concat(t," ").concat(a))}if(B.values.valor_igm){var o=Number(Number(B.values.valor_igm)*Number(B.values.factor_multiplicador)/Number(B.values.cutoff_igm)).toFixed(1),r=Object(I.q)(b.camposEstudio,"resultado_igg","unidad"),n=Object(I.n)(o,Number(B.values.factor_multiplicador));B.setFieldValue("resultado_igm","".concat(o," ").concat(r," ").concat(n))}}}}),[B.values]);var Q=function(e,t){var a=[],o=[],r=0,n=e.filter((function(e){if("DIVISOR"==e.tipo)return r>0&&(a[r-1].campos=o),a.push({index:r,title:e.label,active:!1,campos:[],content:null}),o=[],r++,e;r>0&&o.push(e)}));return o.length>0&&a.length>0&&(a[r-1].campos=o),"count"===t?n.length:a};return R("div",null,R("div",{className:"flex flex-row mb-4"},R("div",{className:"w-full"},R(N.a,{items:i,home:!0,icon:"arrow"}))),t||!k?R("div",{className:"w-full px-4"},R("div",null,R(m.a,{css:_,size:80,color:"#000"}))):R("div",{className:"w-full px-4"},R(D.a,{title:"Orden No. ".concat(b.ordenNo," | Estudio: ").concat(b.estudioID.nombre," | ").concat(b.codigoEstudio).concat(b.estudioNumero),subtitle:R(d.a,{href:"/pacientes/detalle/".concat(b.ordenID.clientID.id)},"Paciente: ".concat(b.ordenID.clientID.nombres," ").concat(b.ordenID.clientID.apellidos))}),R(y.a,{title:"",description:R("span",null,"Datos generales")},R("div",{className:"flex flex-col lg:flex-row lg:flex-wrap w-full lg:space-x-4"},R("div",{className:"flex flex-col w-3/4"},R("div",{className:"text-sm mb-1"},"Fecha Solicitud: ","".concat(g()(b.fechaSolicitud).utc().format("DD/MM/YYYY"))),R("div",{className:"text-sm mb-1"},"Fecha Toma de muestra:","00:00"===g()(b.fechaTomaDeMuestra).utc().format("HH:mm")?" ".concat(g()(b.fechaTomaDeMuestra).utc().format("DD/MM/YYYY")):" ".concat(g()(b.fechaTomaDeMuestra).utc().format("DD/MM/YYYY HH:mm"))),R("div",{className:"text-sm mb-1"},"Tipo de muestra: ",b.tipoDeMuestraID.nombre),R("div",{className:"text-sm mb-1"},"Tipo de cliente: ",b.ordenID.proveedorID.nombre),R("div",{className:"text-sm mb-1"},"Nota/Informaci\xf3n clinica Relevante: ",b.ordenID.nota)))),R(y.a,{title:"",description:R("span",null,"Datos del Estudio")},R("div",{className:"w-full sm:w-full md:w-full lg:w-2/4 xl:w-1/4 pl-3"},R("div",{className:"form-element"},R("div",{className:"form-label"},"Fecha de Toma de muestra"),R(Y.a,{showTimeSelect:!0,locale:"es",dateFormat:"dd-MM-yyyy",selected:B.values.fechaTomaDeMuestra,onChange:function(e){B.setFieldValue("fechaTomaDeMuestra",e)},className:"text-sm"})),b.fechaReporte?R("div",{className:"form-element"},R("div",{className:"form-label"},"Fecha del informe"),R(p.a,{locale:"es",name:"fechaReporte",dateFormat:"DD-MM-YYYY",timeFormat:!1,isValidDate:function(e){return e.isBefore(g()())&&e.isSameOrAfter(g()(b.fechaSolicitud).utc())},input:!0,closeOnSelect:!0,inputProps:{className:"form-input",placeholder:"Seleccione una fecha"},viewMode:"days",value:B.values.fechaReporte,onChange:function(e){B.setFieldValue("fechaReporte",e)}})):null,b.estudioID.tipoDeMuestras.length>1?R("div",{className:"form-element"},R("div",{className:"form-label"},"Tipo de Muestra"),R("select",{className:"form-select",name:"tipoDeMuestraID",placeholder:"Seleccione",onChange:B.handleChange,value:B.values.tipoDeMuestraID},R("option",{value:""},"Seleccione una opcion"),b.estudioID.tipoDeMuestras.map((function(e,t){return R("option",{key:"tdm".concat(t),value:e.id},e.nombre)})))):null,R("div",{className:"form-element"},R("div",{className:"form-label"},"Estado del Estudio"),R("select",{className:"form-select",name:"estadoEstudio",placeholder:"Seleccione",onChange:B.handleChange,value:B.values.estadoEstudio,disabled:"PROCESADO"===b.estadoEstudio},R("option",{value:""},"Seleccione una opcion"),R("option",{value:"RECIBIDO"},"Recibido"),R("option",{value:"EN_PROCESO"},"En Proceso"),R("option",{value:"PROCESADO"},"Procesado"),R("option",{value:"CANCELADO"},"Cancelado"))),B.values.showObservation?R("div",{className:"form-element"},R("div",{className:"form-label"},"Observaciones"),R("textarea",{name:"observaciones",type:"text",rows:5,className:"form-select",placeholder:"",onChange:B.handleChange,value:B.values.observaciones})):null,R("div",{className:"form-element"},R("button",{type:"submit",onClick:B.handleSubmit,className:"inline-block px-6 py-1 mt-2 mx-auto mb-3 text-xs font-medium leading-6 text-center text-white uppercase transition bg-blue-700 rounded-full shadow ripple hover:shadow-lg hover:bg-blue-800 focus:outline-none"},"Guardar")))),R(y.a,{description:"Documentos adjuntos"},R(O.a,{estudioOrderId:k}))))}))},vuIU:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var o=a("o46R");function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Object(o.a)(r.key),r)}}function n(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}}},[["ioCw",0,1,4,10,5,11,7,25,2,3,6,8,9,12,14,13,15,18,29,40,41]]]);