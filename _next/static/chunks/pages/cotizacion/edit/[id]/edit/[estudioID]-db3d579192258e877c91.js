_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[67],{"1OyB":function(e,t,r){"use strict";function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.d(t,"a",(function(){return c}))},BsWD:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var c=r("a3WO");function a(e,t){if(e){if("string"==typeof e)return Object(c.a)(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Object(c.a)(e,t):void 0}}},JX7q:function(e,t,r){"use strict";function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.d(t,"a",(function(){return c}))},Ji7U:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var c=r("s4An");function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Object(c.a)(e,t)}},L4s6:function(e,t,r){"use strict";var c=r("nKUr");t.a=function(e){var t=e.title,r=e.subtitle,a=e.right,o=void 0===a?null:a;return Object(c.jsx)("div",{className:"section-title w-full mb-6 pt-3",children:Object(c.jsxs)("div",{className:"flex flex-row items-center justify-between mb-4",children:[Object(c.jsxs)("div",{className:"flex flex-col",children:[Object(c.jsx)("div",{className:"text-xs uppercase font-light text-gray-500",children:t}),Object(c.jsx)("div",{className:"text-xl font-bold",children:r})]}),o]})})}},U8pU:function(e,t,r){"use strict";function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r.d(t,"a",(function(){return c}))},a3WO:function(e,t,r){"use strict";function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,c=Array(t);r<t;r++)c[r]=e[r];return c}r.d(t,"a",(function(){return c}))},foSv:function(e,t,r){"use strict";function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r.d(t,"a",(function(){return c}))},ftaV:function(e,t,r){"use strict";var c=r("nKUr"),a=r("TSYQ"),o=r.n(a);t.a=function(e){var t=e.className,r=e.round,a=e.height,n=e.width;return Object(c.jsx)("div",{className:o()(t,"shimmer","shimmer-line",{"shimmer-round":r}),style:{height:a,width:n}})}},hKE6:function(e,t,r){"use strict";var c=r("xvhg"),a=r("nKUr"),o=r("q1tI"),n=r("jRMg"),i=function(e){var t=e.accept,r=void 0===t?[]:t,c=e.onChange;return Object(a.jsxs)("div",{children:[Object(a.jsxs)("div",{className:"relative h-40 rounded-lg border-dashed border-2 border-gray-200 bg-white flex justify-center items-center hover:cursor-pointer",children:[Object(a.jsx)("div",{className:"absolute",children:Object(a.jsx)("div",{className:"flex flex-col items-center",children:Object(a.jsx)("span",{className:"block text-blue-400 font-normal",children:"Haz click aqu\xed para cargar un archivo"})})}),Object(a.jsx)("input",{type:"file",className:"h-full w-full opacity-0",accept:r.join(","),onChange:c})]}),Object(a.jsxs)("div",{className:"flex justify-between items-center text-gray-400",children:[Object(a.jsx)("span",{children:"Solo se aceptan archivos de tipo: PDF, DOC, DOCX, JPG, PNG"}),Object(a.jsx)("span",{className:"flex items-center ",children:"Max. 5MB"})]})]})},s=r("ma3e"),l=r("ftaV"),u=r("n7fY"),d=function(e){var t=e.id,r=e.fileName,c=e.fileURL,n=e.loading,i=e.mimeType,d=e.onRemove,b=Object(o.useCallback)((function(){d&&d(t)}),[t]);return n?Object(a.jsxs)("div",{children:[Object(a.jsx)(l.a,{height:"10px",className:"mb-1"}),Object(a.jsx)(l.a,{height:"10px",width:"20%"})]}):Object(a.jsxs)("div",{className:"flex items-start justify-start p-2 space-x-4",children:[Object(a.jsxs)("div",{className:"flex flex-col w-full",children:[Object(a.jsx)("div",{className:"text-sm font-bold",children:r}),Object(a.jsx)("div",{className:"text-sm text-gray-500",children:i})]}),Object(a.jsxs)("div",{className:"flex-shrink-0",children:[Object(a.jsx)("a",{className:"btn btn-default bg-transparent bg-rounded hover:bg-blue-50 hover:text-blue-600 text-blue-500",href:c,target:"_blank",children:"DESCARGAR"}),Object(a.jsx)(u.a,{color:"danger",flat:!0,rounded:!0,onClick:b,children:Object(a.jsx)(s.i,{style:{display:"inline"}})})]})]})},b=r("VreA"),f=r("iX8M");t.a=function(e){var t=e.estudioOrderId,r=Object(o.useState)(),s=r[0],l=r[1],u=Object(n.e)(b.a,{variables:{id:t},refetchAfterMutations:[{mutation:f.b},{mutation:f.C}]}),m=(u.loading,u.data),j=Object(n.d)(f.b),h=Object(c.a)(j,2),O=h[0],v=h[1].loading,p=Object(n.d)(f.C),x=Object(c.a)(p,1)[0],g=Object(o.useCallback)((function(e){var r=e.target;r.validity&&O({variables:{id:t,file:r.files[0]}})}),[t]),D=Object(o.useCallback)((function(e){confirm("Estas seguro de eliminar?")&&(l(e),x({variables:{id:t,fileId:e}}))}),[t]),N=Object(o.useMemo)((function(){return(null===m||void 0===m?void 0:m.getEstudioPorOrden)?m.getEstudioPorOrden.attachmentFiles:[]}),[m]);return Object(a.jsxs)("div",{children:[Object(a.jsxs)("div",{className:"w-full mb-4",children:[N.map((function(e){return Object(a.jsx)(d,{id:e.id,fileName:e.name,fileURL:e.url,mimeType:e.mimeType,onRemove:D,loading:s===e.id})})),v&&Object(a.jsx)(d,{loading:!0})]}),Object(a.jsx)(i,{accept:[".pdf",".doc",".docx",".jpg",".png"],onChange:g})]})}},ioCw:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cotizacion/edit/[id]/edit/[estudioID]",function(){return r("tB1a")}])},md7G:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var c=r("U8pU"),a=r("JX7q");function o(e,t){if(t&&("object"==Object(c.a)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Object(a.a)(e)}},n7fY:function(e,t,r){"use strict";var c=r("nKUr"),a=r("TSYQ"),o=r.n(a);t.a=function(e){var t=e.children,r=e.circle,a=e.color,n=e.flat,i=e.rounded,s=e.onClick;return Object(c.jsx)("button",{className:o()("btn btn-default",{"bg-blue-500":!n&&null==a,"bg-red-500":!n&&null!=a,"bg-transparent":n,"bg-rounded":i,"bg-circle":r,"hover:bg-blue-50":null==a,"hover:bg-red-50":"danger"===a,"hover:text-blue-600":null==a,"hover:text-red-600":"danger"===a,"text-blue-500":n&&null==a,"text-red-500":n&&"danger"===a,"text-white":!n}),onClick:s,children:t})}},o46R:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var c=r("U8pU");function a(e){var t=function(e,t){if("object"!=Object(c.a)(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=Object(c.a)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Object(c.a)(t)?t:t+""}},rePB:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var c=r("o46R");function a(e,t,r){return(t=Object(c.a)(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},tB1a:function(e,t,r){"use strict";r.r(t);var c=r("xvhg"),a=r("jT3O"),o=r("nKUr"),n=r("q1tI"),i=r("jRMg"),s=r("nOHt"),l=r("KYPV"),u=r("YFqc"),d=r.n(u),b=r("qGs6"),f=r.n(b),m=r("qKvR"),j=r("y2g3"),h=r.n(j),O=r("wd/R"),v=r.n(O),p=r("hKE6"),x=r("L4s6"),g=r("6nGu"),D=r("gWdR"),N=r("IqVg"),y=r("VreA"),w=r("iX8M"),E=r("DFyN"),M=r("TCCB"),S=r("z0WU"),I=r("NRhA"),Y=r.n(I),P=(r("5Buo"),r("1UYf"));function R(){var e=Object(a.a)(["\n  display: block;\n  margin: 0 auto;\n  border-color: '#000';\n"]);return R=function(){return e},e}Object(I.registerLocale)("es",P.a);var C=Object(m.css)(R());t.default=Object(E.a)((function(){var e=Object(n.useState)(!0),t=e[0],r=e[1],a=Object(n.useState)([]),u=a[0],b=a[1],m=Object(n.useState)([]),j=m[0],O=m[1],E=Object(n.useState)(null),I=(E[0],E[1]),P=Object(n.useState)({}),R=P[0],_=P[1],T=(Object(M.b)().userInformation,Object(s.useRouter)()),q=T.query,U=q.estudioID,F=q.id,k=Object(i.c)(y.i),A=Object(c.a)(k,1)[0],L=Object(i.d)(w.w),V=Object(c.a)(L,1)[0],B=Object(l.b)({initialValues:R,enableReinitialize:!0,onSubmit:function(e){var t=j.camposEstudio.map((function(t){return"observaciones"!==t.nombre&&"observacion"!==t.nombre||(t.valor=e.observaciones),t})),r=6e4*(new Date).getTimezoneOffset(),c=new Date(e.fechaTomaDeMuestra-r).toISOString().slice(0,-1),a=e.showObservation?{estadoEstudio:e.estadoEstudio,fechaTomaDeMuestra:c,fechaReporte:e.fechaReporte?v()(e.fechaReporte).utc().format("YYYY-MM-DD"):"",fechaSolicitud:v()(j.fechaSolicitud).utc().format("YYYY-MM-DD"),tipoDeMuestraID:e.tipoDeMuestraID,camposEstudio:t}:{estadoEstudio:e.estadoEstudio,fechaTomaDeMuestra:c,fechaReporte:e.fechaReporte?v()(e.fechaReporte).utc().format("YYYY-MM-DD"):"",fechaSolicitud:v()(j.fechaSolicitud).utc().format("YYYY-MM-DD"),tipoDeMuestraID:e.tipoDeMuestraID};V({variables:{id:j.id,input:a}}).then((function(e){var t=e.data,r=e.error;if(r){console.log(r);var c="Hubo un error al editar la informaci\xf3n del estudio.";return r.graphQLErrors&&r.graphQLErrors.length>0&&r.graphQLErrors.map((function(e){c+="\n".concat(e.message," ")})),Object(N.a)("error",c),void T.push("/orden/detail/".concat(F))}t.editDataEstudio&&(Object(N.a)("success","Los datos del estudio fueron actualizados correctamente."),T.push("/orden/detail/".concat(F)))}))}});var H=function(e){return!1!==Object(S.r)(e,"observaciones")||!1!==Object(S.r)(e,"observacion")};Object(n.useEffect)((function(){T.query.estudioID&&function(e){A({variables:{id:e}}).then((function(e){var t,c=e.data,a=e.error;if(a){console.log(a);var o="Hubo un error al obtener la informaci\xf3n del estudio.";return a.graphQLErrors&&a.graphQLErrors.length>0&&a.graphQLErrors.map((function(e){o+="\n".concat(e.message," ")})),Object(N.a)("error",o),void T.push("/buscar-orden")}if(!c.getEstudioPorOrden)return Object(N.a)("error","El estudio a editar no existe."),void T.push("/orden/edit/".concat(T.query.id));if(c&&c.getEstudioPorOrden){var n=new Date(v()(c.getEstudioPorOrden.fechaTomaDeMuestra).utcOffset(0,!1).format("MM/DD/YYYY HH:mm"));O(c.getEstudioPorOrden);var i=[];i.push({title:"Inicio",url:"/dashboard",last:!1}),i.push({title:"Buscar Orden",url:"/buscar-orden",last:!1}),i.push({title:"Editar Orden #".concat(c.getEstudioPorOrden.ordenNo),url:"/orden/edit/".concat(T.query.id),last:!1}),i.push({title:"Edici\xf3n estudio ".concat(c.getEstudioPorOrden.codigoEstudio).concat(c.getEstudioPorOrden.estudioNumero),url:"/orden/edit/".concat(T.query.id,"/edit/").concat(U),last:!0}),b(i),I(K(c.getEstudioPorOrden.camposEstudio)),_({estadoEstudio:c.getEstudioPorOrden.estadoEstudio,fechaReporte:c.getEstudioPorOrden.fechaReporte?v()(c.getEstudioPorOrden.fechaReporte).utc():"",tipoDeMuestraID:c.getEstudioPorOrden.tipoDeMuestraID.id,fechaTomaDeMuestra:n,observaciones:(t=c.getEstudioPorOrden.camposEstudio,!1===Object(S.r)(t,"observaciones")?Object(S.q)(t,"observacion"):Object(S.q)(t,"observaciones")),showObservation:H(c.getEstudioPorOrden.camposEstudio)})}r(!1)}))}(T.query.estudioID)}),[T.query]),Object(n.useEffect)((function(){if(j&&j.estudioID)switch(j.estudioID.id){case"604e2602cc5c345ec442f32e":if(B.values.cutoff_igg&&B.values.cutoff_igm&&B.values.factor_multiplicador){if(B.values.valor_igg){var e=Number(Number(B.values.valor_igg)*Number(B.values.factor_multiplicador)/Number(B.values.cutoff_igg)).toFixed(1),t=Object(S.q)(j.camposEstudio,"resultado_igg","unidad"),r=Object(S.n)(e,Number(B.values.factor_multiplicador));B.setFieldValue("resultado_igg","".concat(e," ").concat(t," ").concat(r))}if(B.values.valor_igm){var c=Number(Number(B.values.valor_igm)*Number(B.values.factor_multiplicador)/Number(B.values.cutoff_igm)).toFixed(1),a=Object(S.q)(j.camposEstudio,"resultado_igg","unidad"),o=Object(S.n)(c,Number(B.values.factor_multiplicador));B.setFieldValue("resultado_igm","".concat(c," ").concat(a," ").concat(o))}}}}),[B.values]);var K=function(e,t){var r=[],c=[],a=0,o=e.filter((function(e){if("DIVISOR"==e.tipo)return a>0&&(r[a-1].campos=c),r.push({index:a,title:e.label,active:!1,campos:[],content:null}),c=[],a++,e;a>0&&c.push(e)}));return c.length>0&&r.length>0&&(r[a-1].campos=c),"count"===t?o.length:r};return t||!U?Object(o.jsxs)("div",{children:[Object(o.jsx)("div",{className:"flex flex-row mb-4",children:Object(o.jsx)("div",{className:"w-full",children:Object(o.jsx)(g.a,{items:u,home:!0,icon:"arrow"})})}),Object(o.jsx)("div",{className:"w-full px-4",children:Object(o.jsx)("div",{children:Object(o.jsx)(f.a,{css:C,size:80,color:"#000"})})})]}):Object(o.jsxs)("div",{children:[Object(o.jsx)("div",{className:"flex flex-row mb-4",children:Object(o.jsx)("div",{className:"w-full",children:Object(o.jsx)(g.a,{items:u,home:!0,icon:"arrow"})})}),Object(o.jsxs)("div",{className:"w-full px-4",children:[Object(o.jsx)(x.a,{title:"Orden No. ".concat(j.ordenNo," | Estudio: ").concat(j.estudioID.nombre," | ").concat(j.codigoEstudio).concat(j.estudioNumero),subtitle:Object(o.jsx)(d.a,{href:"/pacientes/detalle/".concat(j.ordenID.clientID.id),children:"Paciente: ".concat(j.ordenID.clientID.nombres," ").concat(j.ordenID.clientID.apellidos)})}),Object(o.jsx)(D.a,{title:"",description:Object(o.jsx)("span",{children:"Datos generales"}),children:Object(o.jsx)("div",{className:"flex flex-col lg:flex-row lg:flex-wrap w-full lg:space-x-4",children:Object(o.jsxs)("div",{className:"flex flex-col w-3/4",children:[Object(o.jsxs)("div",{className:"text-sm mb-1",children:["Fecha Solicitud: ","".concat(v()(j.fechaSolicitud).utc().format("DD/MM/YYYY"))]}),Object(o.jsxs)("div",{className:"text-sm mb-1",children:["Fecha Toma de muestra:","00:00"===v()(j.fechaTomaDeMuestra).utc().format("HH:mm")?" ".concat(v()(j.fechaTomaDeMuestra).utc().format("DD/MM/YYYY")):" ".concat(v()(j.fechaTomaDeMuestra).utc().format("DD/MM/YYYY HH:mm"))]}),Object(o.jsxs)("div",{className:"text-sm mb-1",children:["Tipo de muestra: ",j.tipoDeMuestraID.nombre]}),Object(o.jsxs)("div",{className:"text-sm mb-1",children:["Tipo de cliente: ",j.ordenID.proveedorID.nombre]}),Object(o.jsxs)("div",{className:"text-sm mb-1",children:["Nota/Informaci\xf3n clinica Relevante: ",j.ordenID.nota]})]})})}),Object(o.jsx)(D.a,{title:"",description:Object(o.jsx)("span",{children:"Datos del Estudio"}),children:Object(o.jsxs)("div",{className:"w-full sm:w-full md:w-full lg:w-2/4 xl:w-1/4 pl-3",children:[Object(o.jsxs)("div",{className:"form-element",children:[Object(o.jsx)("div",{className:"form-label",children:"Fecha de Toma de muestra"}),Object(o.jsx)(Y.a,{showTimeSelect:!0,locale:"es",dateFormat:"dd-MM-yyyy",selected:B.values.fechaTomaDeMuestra,onChange:function(e){B.setFieldValue("fechaTomaDeMuestra",e)},className:"text-sm"})]}),j.fechaReporte?Object(o.jsxs)("div",{className:"form-element",children:[Object(o.jsx)("div",{className:"form-label",children:"Fecha del informe"}),Object(o.jsx)(h.a,{locale:"es",name:"fechaReporte",dateFormat:"DD-MM-YYYY",timeFormat:!1,isValidDate:function(e){return e.isBefore(v()())&&e.isSameOrAfter(v()(j.fechaSolicitud).utc())},input:!0,closeOnSelect:!0,inputProps:{className:"form-input",placeholder:"Seleccione una fecha"},viewMode:"days",value:B.values.fechaReporte,onChange:function(e){B.setFieldValue("fechaReporte",e)}})]}):null,j.estudioID.tipoDeMuestras.length>1?Object(o.jsxs)("div",{className:"form-element",children:[Object(o.jsx)("div",{className:"form-label",children:"Tipo de Muestra"}),Object(o.jsxs)("select",{className:"form-select",name:"tipoDeMuestraID",placeholder:"Seleccione",onChange:B.handleChange,value:B.values.tipoDeMuestraID,children:[Object(o.jsx)("option",{value:"",children:"Seleccione una opcion"}),j.estudioID.tipoDeMuestras.map((function(e,t){return Object(o.jsx)("option",{value:e.id,children:e.nombre},"tdm".concat(t))}))]})]}):null,Object(o.jsxs)("div",{className:"form-element",children:[Object(o.jsx)("div",{className:"form-label",children:"Estado del Estudio"}),Object(o.jsxs)("select",{className:"form-select",name:"estadoEstudio",placeholder:"Seleccione",onChange:B.handleChange,value:B.values.estadoEstudio,disabled:"PROCESADO"===j.estadoEstudio,children:[Object(o.jsx)("option",{value:"",children:"Seleccione una opcion"}),Object(o.jsx)("option",{value:"RECIBIDO",children:"Recibido"}),Object(o.jsx)("option",{value:"EN_PROCESO",children:"En Proceso"}),Object(o.jsx)("option",{value:"PROCESADO",children:"Procesado"}),Object(o.jsx)("option",{value:"CANCELADO",children:"Cancelado"})]})]}),B.values.showObservation?Object(o.jsxs)("div",{className:"form-element",children:[Object(o.jsx)("div",{className:"form-label",children:"Observaciones"}),Object(o.jsx)("textarea",{name:"observaciones",type:"text",rows:5,className:"form-select",placeholder:"",onChange:B.handleChange,value:B.values.observaciones})]}):null,Object(o.jsx)("div",{className:"form-element",children:Object(o.jsx)("button",{type:"submit",onClick:B.handleSubmit,className:"inline-block px-6 py-1 mt-2 mx-auto mb-3 text-xs font-medium leading-6 text-center text-white uppercase transition bg-blue-700 rounded-full shadow ripple hover:shadow-lg hover:bg-blue-800 focus:outline-none",children:"Guardar"})})]})}),Object(o.jsx)(D.a,{description:"Documentos adjuntos",children:Object(o.jsx)(p.a,{estudioOrderId:U})})]})]})}))},vuIU:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var c=r("o46R");function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,Object(c.a)(a.key),a)}}function o(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}}},[["ioCw",0,1,4,10,5,11,7,25,2,3,6,8,9,12,14,13,15,18,29,41,42]]]);